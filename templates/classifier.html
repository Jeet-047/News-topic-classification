<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI News Classifier - Predict</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@300;500;700&family=Inter:wght[:300,:400,:600]&display=swap" rel="stylesheet">
    <style>
        html {
            overflow-x: hidden;
            overflow-y: auto;
            width: 100%;
            scroll-behavior: smooth;
        }
        
        body {
            font-family: 'Inter', sans-serif;
            background-color: #050b14;
            color: #e2e8f0;
            min-height: 100vh;
            position: relative;
            overflow-x: hidden; /* Prevent horizontal scroll */
            overflow-y: auto; /* Allow vertical scroll to see results */
            width: 100%;
            max-width: 100vw;
        }

        /* Ambient Background Orbs (Added for depth) */
        .orb {
            position: absolute;
            border-radius: 50%;
            filter: blur(80px);
            opacity: 0.4;
            z-index: 0;
            pointer-events: none;
        }
        .orb-1 {
            width: 300px; height: 300px;
            background: #4f46e5; /* Indigo */
            top: -150px; left: 10%;
            animation: float 10s ease-in-out infinite;
        }
        .orb-2 {
            width: 400px; height: 400px;
            background: #7c3aed; /* Violet */
            bottom: -200px; right: 5%;
            animation: float 12s ease-in-out infinite reverse;
        }
        @keyframes float {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-30px); }
        }

        /* Tech Grid Background */
        .bg-grid {
            position: fixed;
            top: 0; left: 0; width: 100%; height: 100%;
            background-image: 
                linear-gradient(rgba(15, 23, 42, 0.9), rgba(15, 23, 42, 0.9)),
                linear-gradient(90deg, rgba(99, 102, 241, 0.1) 1px, transparent 1px),
                linear-gradient(rgba(99, 102, 241, 0.1) 1px, transparent 1px);
            background-size: 100% 100%, 40px 40px, 40px 40px;
            z-index: 0;
        }

        /* Tech Card Styling (Z-index raised above orbs) */
        .tech-card {
            background: rgba(15, 23, 42, 0.6);
            backdrop-filter: blur(12px);
            border: 1px solid rgba(99, 102, 241, 0.2);
            box-shadow: 0 0 40px rgba(0,0,0,0.5);
            position: relative;
            overflow: hidden;
            z-index: 10; 
        }

        /* Decorative Corners */
        .corner {
            position: absolute;
            width: 20px;
            height: 20px;
            border: 2px solid #6366f1;
            transition: all 0.3s ease;
        }
        .corner-tl { top: 0; left: 0; border-right: 0; border-bottom: 0; }
        .corner-tr { top: 0; right: 0; border-left: 0; border-bottom: 0; }
        .corner-bl { bottom: 0; left: 0; border-right: 0; border-top: 0; }
        .corner-br { bottom: 0; right: 0; border-left: 0; border-top: 0; }

        .tech-card:hover .corner { width: 30px; height: 30px; box-shadow: 0 0 10px #6366f1; }

        /* Scanning Animation Line */
        .scan-line {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 2px;
            background: linear-gradient(90deg, transparent, #6366f1, transparent);
            box-shadow: 0 0 10px #6366f1;
            opacity: 0;
            pointer-events: none;
            z-index: 10;
        }
        .scanning .scan-line {
            opacity: 1;
            animation: scan 1.5s linear infinite;
        }

        @keyframes scan {
            0% { top: 0%; opacity: 0; }
            10% { opacity: 1; }
            90% { opacity: 1; }
            100% { top: 100%; opacity: 0; }
        }

        /* Neon Textarea */
        .neon-input {
            background: rgba(15, 23, 42, 0.4);
            border: 1px solid rgba(255, 255, 255, 0.1);
            transition: all 0.3s ease;
            font-family: 'Space Grotesk', monospace;
        }
        .neon-input:focus {
            background: rgba(15, 23, 42, 0.8);
            border-color: #6366f1;
            box-shadow: 0 0 15px rgba(99, 102, 241, 0.2);
            outline: none;
        }

        /* Result Neon Text Effect */
        .result-neon-text {
            text-shadow: 0 0 10px rgba(255, 255, 255, 0.5), 0 0 20px rgba(99, 102, 241, 0.8);
        }

        h1, h2, h3, .brand-font { font-family: 'Space Grotesk', sans-serif; }
    </style>
</head>
<body class="p-4 md:p-8 flex items-center justify-center min-h-screen">

    <div class="bg-grid"></div>
    <div class="orb orb-1"></div>
    <div class="orb orb-2"></div>

    <!-- Added responsive horizontal padding for small screens -->
    <div class="max-w-4xl w-full relative z-10 px-2 sm:px-0">
        
        <!-- Navbar / Header -->
        <div class="flex items-center justify-between mb-8 px-0 sm:px-2">
            <a href="/" class="flex items-center text-slate-400 hover:text-indigo-400 transition-colors group">
                <div class="p-2 rounded-full border border-slate-700 group-hover:border-indigo-500 mr-3 transition-colors">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 transform group-hover:-translate-x-1 transition-transform" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 19l-7-7m0 0l7-7m-7 7h18" />
                    </svg>
                </div>
                <span class="font-bold tracking-widest text-xs uppercase">Abort / Return</span>
            </a>
            <div class="text-right">
                <div class="text-indigo-500 font-bold tracking-widest text-xs uppercase brand-font">ML Engine</div>
                <div class="text-slate-600 text-[10px] uppercase">System Ready</div>
            </div>
        </div>

        <!-- Main Tech Card -->
        <div class="tech-card rounded-xl p-1 relative">
            <!-- Decorative Corners -->
            <div class="corner corner-tl"></div>
            <div class="corner corner-tr"></div>
            <div class="corner corner-bl"></div>
            <div class="corner corner-br"></div>

            <!-- Responsive padding: smaller on mobile, larger on desktop -->
            <div class="p-6 sm:p-8 md:p-12">
                <!-- Responsive Header size -->
                <h2 class="text-3xl sm:text-4xl font-bold mb-2 text-white brand-font tracking-tight">Input Data Stream</h2>
                <p class="text-slate-400 mb-6 sm:mb-8 font-light text-sm">Paste the raw text below for real-time topic extraction.</p>
                
                <form id="predictForm" class="space-y-6 sm:space-y-8 relative">
                    <div class="relative group">
                        <div id="scanLine" class="scan-line"></div>
                        <!-- Responsive padding for text area -->
                        <textarea id="newsText" rows="8" 
                            class="neon-input w-full rounded-lg p-4 sm:p-6 text-indigo-100 placeholder-slate-600 resize-none text-base leading-relaxed"
                            placeholder=">_ Enter news article content here..."></textarea>
                        
                        <!-- Floating Label / Badge -->
                        <div class="absolute bottom-4 right-4 text-xs text-slate-500 font-mono" id="charCount">0 chars</div>
                    </div>

                    <!-- Responsive flex layout: stacked on mobile (flex-col), side-by-side on desktop (md:flex-row) -->
                    <div class="flex flex-col md:flex-row items-center justify-between gap-4 sm:gap-6">
                        
                        <!-- Status Display -->
                        <div id="statusArea" class="flex items-center space-x-3 opacity-0 transition-opacity">
                            <div class="flex space-x-1">
                                <span class="w-1 h-3 bg-indigo-500 animate-pulse"></span>
                                <span class="w-1 h-3 bg-indigo-500 animate-pulse delay-75"></span>
                                <span class="w-1 h-3 bg-indigo-500 animate-pulse delay-150"></span>
                            </div>
                            <span class="text-xs font-mono text-indigo-400 uppercase tracking-wider">Processing Neural Net...</span>
                        </div>

                        <!-- Button is full width on mobile, auto width on desktop. Responsive padding. -->
                        <button type="submit" id="submitBtn" disabled
                            class="w-full md:w-auto bg-gradient-to-r from-indigo-600 to-violet-600 hover:from-indigo-500 hover:to-violet-500 disabled:opacity-50 disabled:cursor-not-allowed text-white px-8 py-3 md:px-10 md:py-4 rounded-lg font-bold transition-all shadow-lg shadow-indigo-900/30 tracking-wide uppercase text-sm border border-white/10 hover:border-white/20 hover:scale-[1.02]">
                            Classify News
                        </button>
                    </div>
                </form>

                <!-- Results Overlay -->
                <div id="resultArea" class="mt-6 sm:mt-8 hidden border-t border-slate-800 pt-6 sm:pt-8">
                    <div class="flex flex-col items-center justify-center animate-fade-in-up">
                        <span class="text-slate-500 text-[10px] uppercase tracking-[0.2em] mb-3">Classification Confidence: High</span>
                        
                        <div class="relative group cursor-default">
                            <div class="absolute -inset-1 bg-gradient-to-r from-indigo-500 to-purple-600 rounded-lg blur opacity-25 group-hover:opacity-50 transition duration-1000 group-hover:duration-200"></div>
                            <div class="relative bg-slate-900 ring-1 ring-slate-700/50 rounded-lg px-8 py-4 sm:px-12 sm:py-6 flex items-center justify-center space-x-4">
                                
                                <!-- Result Icon Area - Responsive size -->
                                <div id="resultIcon" class="w-6 h-6 sm:w-8 sm:h-8 flex-shrink-0 text-white animate-pulse">
                                    <!-- Icon will be inserted here by JavaScript -->
                                </div>

                                <!-- Result Text - Responsive font size -->
                                <span id="resultTag" class="text-3xl sm:text-4xl md:text-5xl font-black brand-font text-transparent bg-clip-text result-neon-text">
                                    SPORTS
                                </span>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Error Area - Responsive margin and padding -->
                <div id="errorArea" class="mt-4 sm:mt-6 p-3 sm:p-4 bg-red-900/20 border border-red-500/30 rounded text-center text-red-400 hidden font-mono text-sm"></div>
            </div>
        </div>
        
        <div class="mt-4 sm:mt-6 text-center text-slate-700 text-[10px] font-mono">
            Thank you for visiting!! Made with ðŸ’—
        </div>
    </div>

    <script>
        // API URL - using relative path so it works with any host/port
        const API_URL = "/classify";
        
        const form = document.getElementById('predictForm');
        const textField = document.getElementById('newsText');
        const submitBtn = document.getElementById('submitBtn');
        const statusArea = document.getElementById('statusArea');
        const resultArea = document.getElementById('resultArea');
        const resultTag = document.getElementById('resultTag');
        const resultIcon = document.getElementById('resultIcon');
        const errorArea = document.getElementById('errorArea');
        const scanLine = document.getElementById('scanLine');
        const charCount = document.getElementById('charCount');

        const classificationMap = {
            'world': { 
                gradient: 'from-blue-500 to-cyan-400', 
                icon: `<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M12 21a9.004 9.004 0 0 0 8.716-6.749M12 21a9.004 9.004 0 0 1-8.716-6.749M12 21v-4.719m0 0A3.375 3.375 0 0 0 15.375 12H12m8.716 4.251A9.004 9.004 0 0 1 12 21m8.716-4.251c-.488-.999-1.127-1.998-1.92-2.999c-1.171-1.499-2.71-2.998-4.597-4.5c-1.89-1.5-3.88-2.5-5.97-3.25l-.46-.174m-2.91 1.749C5.464 6.75 3 9.381 3 12c0 2.228 1.002 4.237 2.569 5.548c.84.707 1.838 1.391 2.913 2.051M12 12m-9 0a9 9 0 1 1 18 0a9 9 0 0 1-18 0" /></svg>`
            },
            'sport': { 
                gradient: 'from-yellow-400 to-orange-500', 
                icon: `<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M12 6c3.743 0 6.643 3.107 6.643 6.942c0 3.784-2.9 6.877-6.643 6.877S5.357 16.726 5.357 12.942c0-3.835 2.9-6.942 6.643-6.942zm0 0v-4.5m0 0l-1.5 1.5m1.5-1.5l1.5 1.5M12 19.819c-1.076 0-2.07-.394-2.828-1.152S8 16.891 8 15.815M12 19.819c1.076 0 2.07-.394 2.828-1.152S16 16.891 16 15.815m-4 4.004v-4.004m0 0H8m4 0h4m-4-7.538c-.767 0-1.391-.624-1.391-1.391s.624-1.391 1.391-1.391s1.391.624 1.391 1.391s-.624 1.391-1.391 1.391z" /></svg>`
            },
            'business': { 
                gradient: 'from-green-500 to-teal-400', 
                icon: `<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M21 12h-5m-6 0h-5m6 0v6m0-6V6m-2 2h4m-4 8h4m2-4a2 2 0 1 0 0-4a2 2 0 0 0 0 4z" /><path stroke-linecap="round" stroke-linejoin="round" d="M18 10a2 2 0 1 0 0-4a2 2 0 0 0 0 4zM6 10a2 2 0 1 0 0-4a2 2 0 0 0 0 4zM12 21a9 9 0 1 0 0-18a9 9 0 0 0 0 18z" /></svg>` 
            },
            'tech': { 
                gradient: 'from-purple-500 to-pink-400', 
                icon: `<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M9 3L3 9M9 3H4a1 1 0 0 0-1 1v5m6-6v6a3 3 0 0 0 3 3h6a3 3 0 0 0 3-3V9m-6-6v6m0-6h6a1 1 0 0 1 1 1v5m0-6v6a3 3 0 0 1-3 3H9a3 3 0 0 1-3-3V9m3 3h6m-6 3h6m-6 3h6M12 18v3" /></svg>`
            },
            'other': { 
                gradient: 'from-gray-500 to-slate-400', 
                icon: `<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M9.879 7.519c1.157-1.157 3.178-1.157 4.335 0L12 10.843l-2.121-3.324zM12 15V17M12 21a9 9 0 1 1 0-18a9 9 0 0 1 0 18z" /></svg>`
            }
        };

        // Character count & Button State
        textField.addEventListener('input', () => {
            const len = textField.value.trim().length;
            charCount.textContent = `${len} chars`;
            submitBtn.disabled = len < 5;
            
            // Subtle typing effect color change
            if(len > 0) {
                textField.classList.add('border-indigo-500/30');
            } else {
                textField.classList.remove('border-indigo-500/30');
            }
        });

        form.addEventListener('submit', async (e) => {
            e.preventDefault();
            
            // Reset UI
            resultArea.classList.add('hidden');
            errorArea.classList.add('hidden');
            statusArea.classList.remove('opacity-0');
            submitBtn.disabled = true;
            
            // Start Scanning Animation
            form.parentElement.classList.add('scanning');

            try {
                // Simulate API call delay for visual effect
                await new Promise(resolve => setTimeout(resolve, 500)); 

                // Note: The actual API call is uncommented now, using the new /classify endpoint.
                
                const response = await fetch(API_URL, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ text: textField.value.trim() })
                });
                
                const data = await response.json();
                if (!response.ok) {
                    throw new Error(data.detail || 'Classification failed.');
                }
                
                // Success
                const topicKey = data.topic.toLowerCase();
                const classificationData = classificationMap[topicKey] || classificationMap['other'];

                resultTag.textContent = data.topic.toUpperCase();
                
                // Dynamic Color Application
                resultTag.className = `text-3xl sm:text-4xl md:text-5xl font-black brand-font text-transparent bg-clip-text bg-gradient-to-r ${classificationData.gradient} result-neon-text`;
                
                // Dynamic Icon Application
                resultIcon.innerHTML = classificationData.icon;
                
                resultArea.classList.remove('hidden');
                
                // Scroll to results on mobile after a short delay to ensure smooth animation
                // Use requestAnimationFrame for better performance
                requestAnimationFrame(() => {
                    setTimeout(() => {
                        resultArea.scrollIntoView({ 
                            behavior: 'smooth', 
                            block: 'center',
                            inline: 'nearest'
                        });
                    }, 300);
                });

            } catch (err) {
                errorArea.textContent = `SYSTEM ERROR: ${err.message}`;
                errorArea.classList.remove('hidden');
            } finally {
                // Stop Scanning
                form.parentElement.classList.remove('scanning');
                statusArea.classList.add('opacity-0');
                submitBtn.disabled = false;
            }
        });
    </script>
</body>
</html>